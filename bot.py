from telegram import Update
from telegram.ext import Application, MessageHandler, filters, CommandHandler, CallbackContext
import logging
import os

from tensorflow.keras.models import load_model
import cv2
import numpy as np

model = load_model('mushroom_classifier.h5')

mushrooms = [
    ("ÐœÑƒÑ…Ð¾Ð¼Ð¾Ñ€ Ð»Ð¸Ð¼Ð¾Ð½Ð½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚"),
    ("ÐœÑƒÑ…Ð¾Ð¼Ð¾Ñ€ ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚"),
    ("ÐœÑƒÑ…Ð¾Ð¼Ð¾Ñ€ Ð¿Ð°Ð½Ñ‚ÐµÑ€Ð½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚"),
    ("ÐœÑƒÑ…Ð¾Ð¼Ð¾Ñ€ ÑÐµÑ€Ð¾-Ñ€Ð¾Ð·Ð¾Ð²Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("ÐŸÐµÑ€ÐµÑ‡Ð½Ñ‹Ð¹ Ð´Ð¾Ð¶Ð´ÐµÐ²Ð¸Ðº", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐžÐ¿Ñ‘Ð½Ð¾Ðº ÑÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð“Ñ€ÐµÐ±ÐµÐ½Ñ‡Ð°Ñ‚Ñ‹Ð¹ Ñ€Ð¾Ð³Ð°Ñ‚Ð¸Ðº", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ð¾ÐºÐ°Ð¹Ð¼Ð»Ñ‘Ð½Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð‘ÐµÐ»Ñ‹Ð¹ Ð³Ñ€Ð¸Ð±", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð‘Ð¾Ñ€Ð¾Ð²Ð¸Ðº ÑÐµÑ‚Ñ‡Ð°Ñ‚Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐšÐ°Ð»Ð¾ÐºÐµÑ€Ð° ÐºÐ»ÐµÐ¹ÐºÐ°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÐ°Ð»Ð¸Ñ†Ð¸Ð½Ð° Ð»Ð¸Ð¼Ð¾Ð½Ð½Ð¾-Ð¶ÐµÐ»Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð›Ð¸ÑÐ¸Ñ‡ÐºÐ° Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ð°Ñ", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ñ‡ÐµÑˆÑƒÐ¹Ñ‡Ð°Ñ‚Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¦ÐµÑ‚Ñ€Ð°Ñ€Ð¸Ñ Ð¸ÑÐ»Ð°Ð½Ð´ÑÐºÐ°Ñ (Ð¸ÑÐ»Ð°Ð½Ð´ÑÐºÐ¸Ð¹ Ð¼Ð¾Ñ…)", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¥Ð»Ð¾Ñ€Ð¾Ñ†Ð¸Ð±Ð¾Ñ€Ð¸Ñ Ð°ÑÑ€ÑƒÐ³Ð¸Ð½Ð°ÑÑ†ÐµÐ½Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¥Ð¾Ð½Ð´Ñ€Ð¾ÑÑ‚ÐµÑ€ÐµÑƒÐ¼ Ð¿ÑƒÑ€Ð¿ÑƒÑ€Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÐ»Ð°Ð´Ð¾Ð½Ð¸Ñ Ð±Ð°Ñ…Ñ€Ð¾Ð¼Ñ‡Ð°Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÐ»Ð°Ð´Ð¾Ð½Ð¸Ñ Ð¾Ð»ÐµÐ½ÑŒÑ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÐ»Ð°Ð´Ð¾Ð½Ð¸Ñ Ð·Ð²ÐµÐ·Ð´Ñ‡Ð°Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð“Ð¾Ð²Ð¾Ñ€ÑƒÑˆÐºÐ° Ð´Ñ‹Ð¼Ñ‡Ð°Ñ‚Ð°Ñ", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("ÐšÐ¾Ð»Ñ‚Ñ€Ð¸Ñ†Ð¸Ñ Ð¼Ð½Ð¾Ð³Ð¾Ð»ÐµÑ‚Ð½ÑÑ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÐ¾Ð¿Ñ€Ð¸Ð½ÐµÐ»Ð»ÑƒÑ Ñ€Ð°ÑÑÐµÑÐ½Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÐ¾Ð¿Ñ€Ð¸Ð½ÐµÐ»Ð»ÑƒÑ ÑÐ»ÑŽÐ´ÑÐ½Ð¾Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐÐ°Ð²Ð¾Ð·Ð½Ð¸Ðº ÑÐµÑ€Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (Ñ Ð°Ð»ÐºÐ¾Ð³Ð¾Ð»ÐµÐ¼)"),
    ("ÐÐ°Ð²Ð¾Ð·Ð½Ð¸Ðº Ð±ÐµÐ»Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐšÑ€ÑŽÑ‡ÐºÐ¾Ð²Ð¸Ð´Ð½Ð°Ñ ÐºÑƒÐ±Ñ‹ÑˆÐºÐ°", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð”ÐµÐ´Ð°Ð»ÐµÐ¾Ð¿ÑÐ¸Ñ ÐºÑ€ÐµÐ¿ÐºÐ¸Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð”ÐµÐ´Ð°Ð»ÐµÐ¾Ð¿ÑÐ¸Ñ Ñ‚Ñ€Ñ‘Ñ…Ñ†Ð²ÐµÑ‚Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð­Ð²ÐµÑ€Ð½Ð¸Ñ Ð¼ÐµÐ·Ð¾Ð¼Ð¾Ñ€Ñ„Ð°", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð­Ð²ÐµÑ€Ð½Ð¸Ñ ÑÐ»Ð¸Ð²Ð¾Ð²Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐžÐ¿Ñ‘Ð½Ð¾Ðº Ð·Ð¸Ð¼Ð½Ð¸Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð¸Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ð±ÐµÑ€Ñ‘Ð·Ð¾Ð²Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº ÐºÑ€Ð°ÑÐ½Ð¾Ð¿Ð¾ÑÑÐ½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ð¿Ð»Ð¾ÑÐºÐ¸Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð“Ñ€Ð°Ñ„Ð¸Ñ Ð¿Ð¸ÑÑŒÐ¼ÐµÐ½Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ñ‚Ñ€Ð¾Ñ‡Ð¾Ðº Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð¡Ñ‚Ñ€Ð¾Ñ‡Ð¾Ðº Ð³Ð¸Ð³Ð°Ð½Ñ‚ÑÐºÐ¸Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð¡Ñ‚Ñ€Ð¾Ñ‡Ð¾Ðº Ð¾ÑÐµÐ½Ð½Ð¸Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚"),
    ("Ð•Ð¶Ð¾Ð²Ð¸Ðº ÐºÐ¾Ñ€Ð°Ð»Ð»Ð¾Ð²Ð¸Ð´Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð›Ð¾Ð¶Ð½Ð¾Ð»Ð¸ÑÐ¸Ñ‡ÐºÐ°", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð›Ð¾Ð¶Ð½Ð¾Ð¾Ð¿Ñ‘Ð½Ð¾Ðº ÑÐµÑ€Ð½Ð¾-Ð¶Ñ‘Ð»Ñ‚Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚"),
    ("Ð›Ð¾Ð¶Ð½Ð¾Ð¾Ð¿Ñ‘Ð½Ð¾Ðº ÐºÐ¸Ñ€Ð¿Ð¸Ñ‡Ð½Ð¾-ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚"),
    ("Ð“Ð¸Ð¿Ð¾Ð³Ð¸Ð¼Ð½Ð¸Ñ Ð²Ð·Ð´ÑƒÑ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐœÐ¾Ñ…Ð¾Ð²Ð¸Ðº ÐºÐ°ÑˆÑ‚Ð°Ð½Ð¾Ð²Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð§Ð°Ð³Ð°", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐžÐ¿Ñ‘Ð½Ð¾Ðº Ð»ÐµÑ‚Ð½Ð¸Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð Ñ‹Ð¶Ð¸Ðº Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð¸Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð“Ñ€ÑƒÐ·Ð´ÑŒ Ð²Ð¾Ð¹Ð»Ð¾Ñ‡Ð½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð“Ñ€ÑƒÐ·Ð´ÑŒ Ñ‡Ñ‘Ñ€Ð½Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº ÑÐµÑ€Ð½Ð¾-Ð¶Ñ‘Ð»Ñ‚Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("ÐŸÐ¾Ð´Ð±ÐµÑ€Ñ‘Ð·Ð¾Ð²Ð¸Ðº Ð±ÐµÐ»Ð¾Ð½Ð¾Ð¶ÐºÐ¾Ð²Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐŸÐ¾Ð´Ð¾ÑÐ¸Ð½Ð¾Ð²Ð¸Ðº ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐŸÐ¾Ð´Ð±ÐµÑ€Ñ‘Ð·Ð¾Ð²Ð¸Ðº Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐŸÐ¾Ð´Ð¾ÑÐ¸Ð½Ð¾Ð²Ð¸Ðº Ñ€Ð°Ð·Ð½Ð¾Ñ†Ð²ÐµÑ‚Ð½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð ÑÐ´Ð¾Ð²ÐºÐ° Ð»Ð¸Ð»Ð¾Ð²Ð¾Ð½Ð¾Ð³Ð°Ñ", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð›Ð¾Ð±Ð°Ñ€Ð¸Ñ Ð»Ñ‘Ð³Ð¾Ñ‡Ð½Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð”Ð¾Ð¶Ð´ÐµÐ²Ð¸Ðº Ð¶ÐµÐ¼Ñ‡ÑƒÐ¶Ð½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½ (Ð¼Ð¾Ð»Ð¾Ð´Ñ‹Ðµ Ð¿Ð»Ð¾Ð´Ð¾Ð²Ñ‹Ðµ Ñ‚ÐµÐ»Ð°)"),
    ("Ð—Ð¾Ð½Ñ‚Ð¸Ðº Ð¿Ñ‘ÑÑ‚Ñ€Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐœÐµÑ€ÑƒÐ»Ð¸ÑƒÑ ÑÑ‚ÑƒÐ´ÐµÐ½Ð¸ÑÑ‚Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐœÑƒÑ‚Ð¸Ð½ÑƒÑ Ð Ð°Ð²ÐµÐ½ÐµÐ»Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐÐµÐºÑ‚Ñ€Ð¸Ñ ÐºÐ¸Ð½Ð¾Ð²Ð°Ñ€Ð½Ð¾-ÐºÑ€Ð°ÑÐ½Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐŸÐ°Ð½ÐµÐ»Ð»ÑŽÑ Ð¶Ñ‘ÑÑ‚ÐºÐ¸Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐŸÐ°Ñ€Ð¼ÐµÐ»Ð¸Ñ Ð±Ð¾Ñ€Ð¾Ð·Ð´Ñ‡Ð°Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ð²Ð¸Ð½ÑƒÑˆÐºÐ° Ñ‚Ð¾Ð½ÐºÐ°Ñ", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚Ð°"),
    ("ÐŸÐµÐ»ÑŒÑ‚Ð¸Ð³ÐµÑ€Ð° Ð°Ñ„Ñ‚Ð¾ÑÑ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐŸÐµÐ»ÑŒÑ‚Ð¸Ð³ÐµÑ€Ð° Ð¿Ñ€ÐµÑ‚ÐµÐºÑÑ‚Ð°Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¤ÐµÐ¾Ñ„Ð¸Ð·Ñ†Ð¸Ñ ÐºÑ€ÑƒÐ³Ð»Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð’ÐµÑÑ‘Ð»ÐºÐ° Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ð°Ñ", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚Ð° Ð² ÑÑ‹Ñ€Ð¾Ð¼ Ð²Ð¸Ð´Ðµ"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ð»Ð¾Ð¶Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ð¾ÑÐ¸Ð½Ð¾Ð²Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¤Ð»ÐµÐ±Ð¸Ñ Ð»ÑƒÑ‡Ð¸ÑÑ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¤Ð¾Ð»Ð¸Ð¾Ñ‚Ð° Ð·Ð¾Ð»Ð¾Ñ‚Ð¸ÑÑ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¤Ð¾Ð»Ð¸Ð¾Ñ‚Ð° Ñ‡ÐµÑˆÑƒÐ¹Ñ‡Ð°Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¤Ð¸Ð·Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð¿Ð¾Ð´Ð½ÑÑ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐŸÐ»Ð°Ñ‚Ð¸Ð·Ð¼Ð°Ñ‚Ð¸Ñ Ð³Ð¾Ð»ÑƒÐ±Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð’Ñ‘ÑˆÐµÐ½ÐºÐ° Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ð°Ñ", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð’Ñ‘ÑˆÐµÐ½ÐºÐ° Ð»Ñ‘Ð³Ð¾Ñ‡Ð½Ð°Ñ", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐŸÑÐµÐ²Ð´Ð¾ÑÐ²ÐµÑ€Ð½Ð¸Ñ Ð¼Ð¾Ñ…Ð½Ð°Ñ‚Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð Ð¸Ñ‚Ð¸Ð·Ð¼Ð° ÐºÐ»Ñ‘Ð½Ð¾Ð²Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ð°Ñ€ÐºÐ¾Ð¼Ð¸ÐºÑÐ° Ð¿Ð¾Ð·Ð´Ð½ÑÑ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ð°Ñ€ÐºÐ¾ÑÑ†Ð¸Ñ„Ð° Ð°Ð²ÑÑ‚Ñ€Ð¸Ð¹ÑÐºÐ°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ð°Ñ€ÐºÐ¾ÑÐ¾Ð¼Ð° ÑˆÐ°Ñ€Ð¾Ð²Ð¸Ð´Ð½Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¨Ð¸Ð·Ð¾Ñ„Ð¸Ð»Ð»ÑƒÐ¼ Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ñ‚ÐµÑ€ÐµÑƒÐ¼ Ð¶Ñ‘ÑÑ‚ÐºÐ¾Ð²Ð¾Ð»Ð¾ÑÐ¸ÑÑ‚Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¡Ñ‚Ñ€Ð¾Ñ„Ð°Ñ€Ð¸Ñ ÑÐ¸Ð½Ðµ-Ð·ÐµÐ»Ñ‘Ð½Ð°Ñ", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚Ð°"),
    ("ÐœÐ°ÑÐ»Ñ‘Ð½Ð¾Ðº Ð·ÐµÑ€Ð½Ð¸ÑÑ‚Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐœÐ°ÑÐ»Ñ‘Ð½Ð¾Ðº Ð»Ð¸ÑÑ‚Ð²ÐµÐ½Ð½Ð¸Ñ‡Ð½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("ÐœÐ°ÑÐ»Ñ‘Ð½Ð¾Ðº Ð¾Ð±Ñ‹ÐºÐ½Ð¾Ð²ÐµÐ½Ð½Ñ‹Ð¹", "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½"),
    ("Ð¢Ñ€Ð°Ð¼ÐµÑ‚ÐµÑ Ð¶Ñ‘ÑÑ‚ÐºÐ¾Ð²Ð¾Ð»Ð¾ÑÐ¸ÑÑ‚Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€Ð°Ð¼ÐµÑ‚ÐµÑ Ð¾Ñ…Ñ€ÑÐ½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€ÑƒÑ‚Ð¾Ð²Ð¸Ðº Ñ€Ð°Ð·Ð½Ð¾Ñ†Ð²ÐµÑ‚Ð½Ñ‹Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð”Ñ€Ð¾Ð¶Ð°Ð»ÐºÐ° Ð¾Ñ€Ð°Ð½Ð¶ÐµÐ²Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€Ð¸Ñ…Ð°Ð¿Ñ‚ÑƒÐ¼ Ð´Ð²Ð¾ÑÐºÐ¸Ð¹", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð¢Ñ€Ð¸Ñ…Ð¾Ð»Ð¾Ð¼Ð¾Ð¿ÑÐ¸Ñ ÐºÑ€Ð°ÑÐ½Ð¾-Ð¶Ñ‘Ð»Ñ‚Ñ‹Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð£Ñ€Ð½ÑƒÐ»Ð° ÐºÑ€Ð°Ñ‚ÐµÑ€Ð¾Ð²Ð¸Ð´Ð½Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("Ð’ÐµÐ¿Ñ€ÑŒ Ñ‡ÐµÑˆÑÐºÐ¸Ð¹", "Ð¯Ð´Ð¾Ð²Ð¸Ñ‚ (ÑƒÑÐ»Ð¾Ð²Ð½Ð¾ ÑÑŠÐµÐ´Ð¾Ð±ÐµÐ½)"),
    ("Ð’ÑƒÐ»ÑŒÐ¿Ð¸Ñ†Ð¸Ð´Ð° ÑÐ¾ÑÐ½Ð¾Ð²Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
    ("ÐšÑÐ°Ð½Ñ‚Ð¾Ñ€Ð¸Ñ Ð½Ð°ÑÑ‚ÐµÐ½Ð½Ð°Ñ", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),
]

def preprocess_image(image_path, img_size=256):
    img = cv2.imread(image_path)
    if img is None:
        raise ValueError("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ! ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿ÑƒÑ‚ÑŒ.")
    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
    img = cv2.resize(img, (img_size, img_size))
    img = img / 255.0
    img = np.expand_dims(img, axis=0)
    return img

def predict_mushroom(img):
    predictions = model.predict(img)
    predicted_class = np.argmax(predictions)
    confidence = np.max(predictions)

    status = ""
    if mushrooms[predicted_class][1] == "Ð¡ÑŠÐµÐ´Ð¾Ð±ÐµÐ½":
        status = 'âœ…'
    elif mushrooms[predicted_class][1] == "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾":
        status = 'â“'
    else:
        status = 'ðŸ”´'

    return f"ðŸ„ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ: {mushrooms[predicted_class][0]}\n{status}Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: {mushrooms[predicted_class][1]}\nðŸ“ŠÐ£Ð²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ: {confidence:.2%}\n"

logging.basicConfig(format="%(asctime)s - %(name)s - %(levelname)s - %(message)s", level=logging.INFO)
logger = logging.getLogger(__name__)

SAVE_DIR = "photos"
os.makedirs(SAVE_DIR, exist_ok=True)

async def start(update: Update, context: CallbackContext) -> None:
    await update.message.reply_text("ðŸš€Send mushroom photo to predictðŸš€")

async def handle_photo(update: Update, context: CallbackContext) -> None:
    photo = update.message.photo[-1]
    file = await context.bot.get_file(photo.file_id)
    file_path = os.path.join(SAVE_DIR, f"{photo.file_id}.jpg")
    await file.download_to_drive(file_path)
    await update.message.reply_text(f"â³Start predicting the mushroomâ³")
    result = predict_mushroom(preprocess_image(file_path))
    await update.message.reply_text(f"{result}")

async def error_handler(update: object, context: CallbackContext) -> None:
    logger.warning(f"Update {update} caused error {context.error}")

def main():
    TOKEN = "7793479455:AAFr4FyFFne4zF0MkegqGIHBDrSpHIZQe50"
    app = Application.builder().token(TOKEN).build()
    
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.PHOTO, handle_photo))
    app.add_error_handler(error_handler)
    
    logger.info("Bot is started!")
    app.run_polling()

if __name__ == "__main__":
    main()
